{"version":3,"file":"Database.js","sourceRoot":"","sources":["../../src/config/Database.ts"],"names":[],"mappings":";AAAA,yDAAyD;AACzD,mEAAmE;AACnE,iFAAiF;;AAEjF;;;;;;;;GAQG;AAEH,6BAA6B;AAC7B,uCAAuC;AACvC,qDAAkD;AAErC,QAAA,cAAc,GAAG;IAC1B,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,SAAS,IAAI,SAAS;IAC1C,UAAU,EAAE;QACR,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,IAAI,iBAAO,CAAC,eAAe,EAAE;KACnE;IACD,IAAI,EAAE;QACF,GAAG,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI,CAAC,EAAE,EAAE,CAAC;QAC/C,GAAG,EAAE,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,WAAW,IAAI,EAAE,EAAE,EAAE,CAAC;QAChD,WAAW,EAAE,CAAC,IAAI,EAAE,EAAE;YAClB,IAAI,CAAC,GAAG,CAAC,0BAA0B,EAAE,EAAE,CAAC,CAAC;YACzC,IAAI,CAAC,GAAG,CAAC,2BAA2B,EAAE,EAAE,CAAC,CAAC;QAC9C,CAAC;KACJ;IACD,UAAU,EAAE;QACR,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,gBAAgB,IAAI,iBAAO,CAAC,wBAAwB,EAAE;QAC7E,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB,IAAI,SAAS;KACzD;IACD,oDAAoD;IACpD,KAAK,EAAE;QACH,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,IAAI,iBAAO,CAAC,mBAAmB,EAAE;KACvE;IACD,gBAAgB,EAAE,IAAI;IACtB,cAAc;IACd,KAAK,EAAE,KAAK;CACf,CAAC;AAEW,QAAA,IAAI,GAAG;IAChB,OAAO,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,SAAS,CAAC,sBAAc,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;IACrE,MAAM,CAAC,IAAI,CAAC,sBAAc,CAAC,CAAC;AAChC,CAAC,CAAC;AAEW,QAAA,SAAS,GAAc,SAAS,CAAC,YAAI,EAAS,CAAC,CAAC;AAC7D,iBAAS,CAAC,MAAM,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC","sourcesContent":["// Copyright (c) 2017-2018, The Particl Market developers\n// Distributed under the GPL software license, see the accompanying\n// file COPYING or https://github.com/particl/particl-market/blob/develop/LICENSE\n\n/**\n * config.Database\n * ------------------------------------\n *\n * Here we configure our database connection and\n * our ORM 'bookshelf'.\n *\n * Here would be the place to add more bookshelf plugins.\n */\n\nimport * as knex from 'knex';\nimport * as bookshelf from 'bookshelf';\nimport { DataDir } from '../core/helpers/DataDir';\n\nexport const DatabaseConfig = {\n    client: process.env.DB_CLIENT || 'sqlite3',\n    connection: {\n        filename: process.env.DB_CONNECTION || DataDir.getDatabaseFile()\n    },\n    pool: {\n        min: parseInt(process.env.DB_POOL_MIN || 2, 10),\n        max: parseInt(process.env.DB_POOL_MAX || 10, 10),\n        afterCreate: (conn, cb) => {\n            conn.run('PRAGMA foreign_keys = ON', cb);\n            conn.run('PRAGMA journal_mode = WAL', cb);\n        }\n    },\n    migrations: {\n        directory: process.env.DB_MIGRATION_DIR || DataDir.getDefaultMigrationsPath(),\n        tableName: process.env.DB_MIGRATION_TABLE || 'version'\n    },\n    // not used anymore, potentially we can delete this.\n    seeds: {\n        directory: process.env.DB_SEEDS_DIR || DataDir.getDefaultSeedsPath()\n    },\n    useNullAsDefault: true,\n    // debug: true\n    debug: false\n};\n\nexport const Knex = (): knex => {\n    console.log('knex config:', JSON.stringify(DatabaseConfig, null, 2));\n    return knex(DatabaseConfig);\n};\n\nexport const Bookshelf: bookshelf = bookshelf(Knex() as any);\nBookshelf.plugin(['bookshelf-camelcase']);\n"]}