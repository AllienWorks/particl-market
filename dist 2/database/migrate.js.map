{"version":3,"file":"migrate.js","sourceRoot":"","sources":["../../src/database/migrate.ts"],"names":[],"mappings":";AAAA,yDAAyD;AACzD,mEAAmE;AACnE,iFAAiF;;AAEjF,iDAA0C;AAC1C,qDAAkD;AAClD,6EAA0E;AAE7D,QAAA,OAAO,GAAG;IAEnB,OAAO,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;IACxC,OAAO,CAAC,GAAG,CAAC,4BAA4B,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;IACrE,OAAO,CAAC,GAAG,CAAC,+BAA+B,EAAE,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;IAC3E,OAAO,CAAC,GAAG,CAAC,2BAA2B,EAAE,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;IAEnE,OAAO,CAAC,GAAG,CAAC,oBAAoB,EAAE,iBAAO,CAAC,cAAc,EAAE,CAAC,CAAC;IAC5D,OAAO,CAAC,GAAG,CAAC,qBAAqB,EAAE,iBAAO,CAAC,eAAe,EAAE,CAAC,CAAC;IAC9D,OAAO,CAAC,GAAG,CAAC,oBAAoB,EAAE,iBAAO,CAAC,cAAc,EAAE,CAAC,CAAC;IAE5D,MAAM,EAAE,GAAG,eAAI,EAAE,CAAC;IAElB,gDAAgD;IAChD,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC;QACf,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE;KACtB,CAAC,CAAC;AACP,CAAC,CAAC;AAEW,QAAA,UAAU,GAAG;IACtB,iBAAO,CAAC,UAAU,CAAC,IAAI,2CAAoB,EAAE,CAAC,CAAC;IAC/C,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC;AAC3B,CAAC,CAAC","sourcesContent":["// Copyright (c) 2017-2018, The Particl Market developers\n// Distributed under the GPL software license, see the accompanying\n// file COPYING or https://github.com/particl/particl-market/blob/develop/LICENSE\n\nimport { Knex } from '../config/Database';\nimport { DataDir } from '../core/helpers/DataDir';\nimport { DevelopmentEnvConfig } from '../config/env/DevelopmentEnvConfig';\n\nexport const migrate = (): Promise<any> => {\n\n    console.log('Running DB migrations...');\n    console.log('process.env.DB_CONNECTION:', process.env.DB_CONNECTION);\n    console.log('process.env.DB_MIGRATION_DIR:', process.env.DB_MIGRATION_DIR);\n    console.log('process.env.DB_SEEDS_DIR:', process.env.DB_SEEDS_DIR);\n\n    console.log('migrate, datadir: ', DataDir.getDataDirPath());\n    console.log('migrate, database: ', DataDir.getDatabasePath());\n    console.log('migrate, uploads: ', DataDir.getUploadsPath());\n\n    const db = Knex();\n\n    // migrate is a bluebird promise, hack around it\n    return Promise.all([\n        db.migrate.latest()\n    ]);\n};\n\nexport const initialize = (): Promise<any> => {\n    DataDir.initialize(new DevelopmentEnvConfig());\n    return exports.migrate;\n};\n"]}